#include "Midi.h"

std::map<std::string, int> gMidiSymToNum = {
    {"OFF", NOTE_OFF},
    {"C-1", 0}, {"C-1#", 1}, {"D-1b", 1}, {"D-1", 2}, {"D-1#", 3}, {"E-1b", 3}, {"E-1", 4},
    {"F-1", 5}, {"F-1#", 6}, {"G-1b", 6}, {"G-1", 7}, {"G-1#", 8}, {"A-1b", 8}, {"A-1", 9},
    {"A-1#", 10}, {"B-1b", 10}, {"B-1", 11},
    {"C0", 12}, {"C0#", 13}, {"D0b", 13}, {"D0", 14}, {"D0#", 15}, {"E0b", 15}, {"E0", 16},
    {"F0", 17}, {"F0#", 18}, {"G0b", 18}, {"G0", 19}, {"G0#", 20}, {"A0b", 20}, {"A0", 21},
    {"A0#", 22}, {"B0b", 22}, {"B0", 23},
    {"C1", 24}, {"C1#", 25}, {"D1b", 25}, {"D1", 26}, {"D1#", 27}, {"E1b", 27}, {"E1", 28},
    {"F1", 29}, {"F1#", 30}, {"G1b", 30}, {"G1", 31}, {"G1#", 32}, {"A1b", 32}, {"A1", 33},
    {"A1#", 34}, {"B1b", 34}, {"B1", 35},
    {"C2", 36}, {"C2#", 37}, {"D2b", 37}, {"D2", 38}, {"D2#", 39}, {"E2b", 39}, {"E2", 40},
    {"F2", 41}, {"F2#", 42}, {"G2b", 42}, {"G2", 43}, {"G2#", 44}, {"A2b", 44}, {"A2", 45},
    {"A2#", 46}, {"B2b", 46}, {"B2", 47},
    {"C3", 48}, {"C3#", 49}, {"D3b", 49}, {"D3", 50}, {"D3#", 51}, {"E3b", 51}, {"E3", 52},
    {"F3", 53}, {"F3#", 54}, {"G3b", 54}, {"G3", 55}, {"G3#", 56}, {"A3b", 56}, {"A3", 57},
    {"A3#", 58}, {"B3b", 58}, {"B3", 59},
    {"C4", 60}, {"C4#", 61}, {"D4b", 61}, {"D4", 62}, {"D4#", 63}, {"E4b", 63}, {"E4", 64},
    {"F4", 65}, {"F4#", 66}, {"G4b", 66}, {"G4", 67}, {"G4#", 68}, {"A4b", 68}, {"A4", 69},
    {"A4#", 70}, {"B4b", 70}, {"B4", 71},
    {"C5", 72}, {"C5#", 73}, {"D5b", 73}, {"D5", 74}, {"D5#", 75}, {"E5b", 75}, {"E5", 76},
    {"F5", 77}, {"F5#", 78}, {"G5b", 78}, {"G5", 79}, {"G5#", 80}, {"A5b", 80}, {"A5", 81},
    {"A5#", 82}, {"B5b", 82}, {"B5", 83},
    {"C6", 84}, {"C6#", 85}, {"D6b", 85}, {"D6", 86}, {"D6#", 87}, {"E6b", 87}, {"E6", 88},
    {"F6", 89}, {"F6#", 90}, {"G6b", 90}, {"G6", 91}, {"G6#", 92}, {"A6b", 92}, {"A6", 93},
    {"A6#", 94}, {"B6b", 94}, {"B6", 95},
    {"C7", 96}, {"C7#", 97}, {"D7b", 97}, {"D7", 98}, {"D7#", 99}, {"E7b", 99}, {"E7", 100},
    {"F7", 101}, {"F7#", 102}, {"G7b", 102}, {"G7", 103}, {"G7#", 104}, {"A7b", 104}, {"A7", 105},
    {"A7#", 106}, {"B7b", 106}, {"B7", 107},
    {"C8", 108}, {"C8#", 109}, {"D8b", 109}, {"D8", 110}, {"D8#", 111}, {"E8b", 111}, {"E8", 112},
    {"F8", 113}, {"F8#", 114}, {"G8b", 114}, {"G8", 115}, {"G8#", 116}, {"A8b", 116}, {"A8", 117},
    {"A8#", 118}, {"B8b", 118}, {"B8", 119},
    {"C9", 120}, {"C9#", 121}, {"D9b", 121}, {"D9", 122}, {"D9#", 123}, {"E9b", 123}, {"E9", 124},
    {"F9", 125}, {"F9#", 126}, {"G9b", 126}, {"G9", 127}
};

std::map<int, std::string> gMidiNumToSym = {
    {NOTE_OFF, "OFF"},
    {0, "C-1"}, {1, "C-1#"}, {1, "D-1b"}, {2, "D-1"}, {3, "D-1#"}, {3, "E-1b"}, {4, "E-1"},
    {5, "F-1"}, {6, "F-1#"}, {6, "G-1b"}, {7, "G-1"}, {8, "G-1#"}, {8, "A-1b"}, {9, "A-1"},
    {10, "A-1#"}, {10, "B-1b"}, {11, "B-1"},
    {12, "C0"}, {13, "C0#"}, {13, "D0b"}, {14, "D0"}, {15, "D0#"}, {15, "E0b"}, {16, "E0"},
    {17, "F0"}, {18, "F0#"}, {18, "G0b"}, {19, "G0"}, {20, "G0#"}, {20, "A0b"}, {21, "A0"},
    {22, "A0#"}, {22, "B0b"}, {23, "B0"},
    {24, "C1"}, {25, "C1#"}, {25, "D1b"}, {26, "D1"}, {27, "D1#"}, {27, "E1b"}, {28, "E1"},
    {29, "F1"}, {30, "F1#"}, {30, "G1b"}, {31, "G1"}, {32, "G1#"}, {32, "A1b"}, {33, "A1"},
    {34, "A1#"}, {34, "B1b"}, {35, "B1"},
    {36, "C2"}, {37, "C2#"}, {37, "D2b"}, {38, "D2"}, {39, "D2#"}, {39, "E2b"}, {40, "E2"},
    {41, "F2"}, {42, "F2#"}, {42, "G2b"}, {43, "G2"}, {44, "G2#"}, {44, "A2b"}, {45, "A2"},
    {46, "A2#"}, {46, "B2b"}, {47, "B2"},
    {48, "C3"}, {49, "C3#"}, {49, "D3b"}, {50, "D3"}, {51, "D3#"}, {51, "E3b"}, {52, "E3"},
    {53, "F3"}, {54, "F3#"}, {54, "G3b"}, {55, "G3"}, {56, "G3#"}, {56, "A3b"}, {57, "A3"},
    {58, "A3#"}, {58, "B3b"}, {59, "B3"},
    {60, "C4"}, {61, "C4#"}, {61, "D4b"}, {62, "D4"}, {63, "D4#"}, {63, "E4b"}, {64, "E4"},
    {65, "F4"}, {66, "F4#"}, {66, "G4b"}, {67, "G4"}, {68, "G4#"}, {68, "A4b"}, {69, "A4"},
    {70, "A4#"}, {70, "B4b"}, {71, "B4"},
    {72, "C5"}, {73, "C5#"}, {73, "D5b"}, {74, "D5"}, {75, "D5#"}, {75, "E5b"}, {76, "E5"},
    {77, "F5"}, {78, "F5#"}, {78, "G5b"}, {79, "G5"}, {80, "G5#"}, {80, "A5b"}, {81, "A5"},
    {82, "A5#"}, {82, "B5b"}, {83, "B5"},
    {84, "C6"}, {85, "C6#"}, {85, "D6b"}, {86, "D6"}, {87, "D6#"}, {87, "E6b"}, {88, "E6"},
    {89, "F6"}, {90, "F6#"}, {90, "G6b"}, {91, "G6"}, {92, "G6#"}, {92, "A6b"}, {93, "A6"},
    {94, "A6#"}, {94, "B6b"}, {95, "B6"},
    {96, "C7"}, {97, "C7#"}, {97, "D7b"}, {98, "D7"}, {99, "D7#"}, {99, "E7b"}, {100, "E7"},
    {101, "F7"}, {102, "F7#"}, {102, "G7b"}, {103, "G7"}, {104, "G7#"}, {104, "A7b"}, {105, "A7"},
    {106, "A7#"}, {106, "B7b"}, {107, "B7"},
    {108, "C8"}, {109, "C8#"}, {109, "D8b"}, {110, "D8"}, {111, "D8#"}, {111, "E8b"}, {112, "E8"},
    {113, "F8"}, {114, "F8#"}, {114, "G8b"}, {115, "G8"}, {116, "G8#"}, {116, "A8b"}, {117, "A8"},
    {118, "A8#"}, {118, "B8b"}, {119, "B8"},
    {120, "C9"}, {121, "C9#"}, {121, "D9b"}, {122, "D9"}, {123, "D9#"}, {123, "E9b"}, {124, "E9"},
    {125, "F9"}, {126, "F9#"}, {126, "G9b"}, {127, "G9"}
};

std::map<int, std::string> createReverseMap() {
    std::map<int, std::string> reverseTable;
    for (const auto& pair : gMidiSymToNum) {
        if (reverseTable.find(pair.second) == reverseTable.end()) { // まだ追加されていない場合
            reverseTable[pair.second] = pair.first;
        }
    }
    return reverseTable;
}

short noteToNumber(std::string note_name) {
    auto x = gMidiSymToNum.find(note_name);
    if (x == gMidiSymToNum.end()) {
        return NOTE_NONE;
    }
    return static_cast<int16_t>(x->second);
}

std::string numberToNote(int16_t key) {
    auto it = gMidiNumToSym.find(key);
    if (it != gMidiNumToSym.end()) {
        return it->second;
    }
    return "";
}
